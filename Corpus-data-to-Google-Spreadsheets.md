# По итогам консультации
такое себе руководство

## НКРЯ → Google Таблицы 
Нижеизложенное особенно пригодится при выполнении [второго семинара по таблицам](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/wiki/%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80-12:-%D1%82%D0%B0%D0%B1%D0%BB%D0%B8%D1%86%D1%8B-(%D1%87%D0%B0%D1%81%D1%82%D1%8C-2)). 

Откройте сайт корпуса и __задайте подкорпус__ (для этого семинара — художественный).
Задайте __запрос__:
  * первое слово: слово — *два|три|четыре|пять|шесть|семь*, грамматические признаки — *NUM,nom*, дополнительные признаки — *-bmark*
  
  * второе слово: грамматические признаки — *A,(gen|acc)*
  
  * третье слово: грамматические признаки — *S,gen*, дополнительные признаки — *-amark* (для того, чтобы появилось ещё одно поле для ввода, нажмите на небольшую стрелочку у правого края "блока поиска" предыдущего слова)
  
![alt-text](./google-spreadsheets%20images/Ruscorpora-to-GS_01.png "Запрос в НКРЯ")

__Скачайте__ выдачу: в конце страницы будут ссылки на скачивание. Выберите формат Excel/OpenOffice (в зависимости от того, что у вас установлено). Файл будет иметь название типа *download_excel.xml*.

![alt-text](./google-spreadsheets%20images/Ruscorpora-to-GS_02.png "Скачивание выдачи")
Если у вас не получается скачать выдачу с сайта НКРЯ (такое бывает), воспользуйтесь [этим файлом](./download-excel.xml).

__Откройте__ полученный файл в редакторе таблиц. Убедитесь, что в нём есть данные и он адекватно выглядит, например, так:

![alt-text](./google-spreadsheets%20images/Ruscorpora-to-GS_03.png "Как выглядит download_excel.xml")
Вы можете заметить, что в столбце Center у вас находится только числительное, а не вся конструкция "числительное + прилагательное + существительное"; ещё два слова отправились в столбец Right context. Это нормально и дальше мы сделаем так, что все слова будут находиться в отдельных столбцах.

![alt-text](./google-spreadsheets%20images/Ruscorpora-to-GS_04.png "Нужные слова в том числе в Right context")

__Сохраните__ этот файл в формате, привычном вашим таблицам (.xls, .xlsx, .ods и им подобные). Для этого воспользуйтесь меню "Сохранить как"/"Save as":

![alt-text](./google-spreadsheets%20images/Ruscorpora-to-GS_06.png "Общий вид для Save As")
![alt-text](./google-spreadsheets%20images/Ruscorpora-to-GS_05.png "Конкретно Excel Workbook")

Затем откройте Google Таблицы. В них __загрузите только что созданный вами файл__ формата "таблиц" (не XML!) при помощи меню *Файл* → *Открыть* → вкладка *Загрузка*. Перетащите ваш файл или нажмите на кнопку *Выберите файл на компьютере*.

![alt-text](./google-spreadsheets%20images/Ruscorpora-to-GS_07.png "Открыть")
![alt-text](./google-spreadsheets%20images/Ruscorpora-to-GS_08.png "Загрузка файла")

Должно получиться как-то так:
![alt-text](./google-spreadsheets%20images/Ruscorpora-to-GS_09.png "Вид загруженного в Google Таблицы файла")

Теперь надо __"разнести" интересующие нас слова на отдельные колонки__. Применим для этого функцию из гугл-таблиц.

__Выделите__ весь столбец Right context (для этого нажмите на букву, обозначающую этот столбец).
  
*Данные* → *__Разделить на колонки__*
  
![alt-text](./google-spreadsheets%20images/Ruscorpora-to-GS_10.png "Разделить на колонки")

Снизу появится маленькая серая плашка, в которой вам предложат __выбрать разделитель__. Так как слова в русском разделяются __пробелами__, их и выбираем.

![alt-text](./google-spreadsheets%20images/Ruscorpora-to-GS_11.png "Выбор разделителя")

Результат работы функции:
  
![alt-text](./google-spreadsheets%20images/Ruscorpora-to-GS_12.png "Разделить на колонки")

### Лирическое отступление
На консультации мы пользовались функцией =SPLIT(), которая делала то же самое. Вышеописанный способ гарантирует вам, что вы не "вывалитесь" в ошибку ССЫЛКА / REF или ОШИБКА / ERROR. Общая концепция такая:
    
Вставить слева от столбца Right context 6 столбцов (воспользуйтесь функцией "Вставить слева", которая появляется при нажатии небольшого треугольничка у буквы, обозначающей столбец).
    
![alt-text](./google-spreadsheets%20images/Ruscorpora-to-GS_13.png "Вставить слева: 1")
    
В самый левый из этих столбцов вставить функцию =SPLIT(ячейка_в_которой_текст_который_вы_разбиваете; " "). Не забудьте "растянуть" формулу на все строки таблицы.
    
![alt-text](./google-spreadsheets%20images/Ruscorpora-to-GS_14.png "Функция SPLIT")
    
Как результат вы должны получить примерно то же самое, что и при работе функции "Разделить на колонки". 
    
![alt-text](./google-spreadsheets%20images/Ruscorpora-to-GS_15.png "Результат работы SPLIT")
    
Тем не менее, если скопировать содержимое этих столбцов в другое мест, то оно "сломается". Чтобы избежать этого, нужно __вставить его как текст__. Для этого сначала __скопируйте__ всё содержимое нужных вам столбцов:
    
![alt-text](./google-spreadsheets%20images/Ruscorpora-to-GS_16.png "Выделяем все столбцы и копируем")

Обратите внимание: область копирования обвелась пунктирной линией. После этого выберите их же, нажмите на треугольничек у названия столбца и выберите *Специальная вставка* → *Вставить только __значения__*. 
    
![alt-text](./google-spreadsheets%20images/Ruscorpora-to-GS_17.png "Вставить только значения")

__NB:__ чтобы проверить, всё ли вы правильно сделали, посмотрите на значение ячейки, где раньше была формула =SPLIT(): теперь там должен быть текст.

## Выгружаем из Аранеума
Кажется, здесь всё немного проще, нежели с НКРЯ. Это пригодится при решении [второй домашки по таблицам](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/wiki/%D0%94%D0%BE%D0%BC%D0%B0%D1%88%D0%BD%D0%B5%D0%B5-%D0%B7%D0%B0%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE-%D1%82%D0%B0%D0%B1%D0%BB%D0%B8%D1%86%D1%8B-(%D1%87%D0%B0%D1%81%D1%82%D1%8C-2)).

Сначала, конечно, __нужно задать запрос__. Для этого идём в корпус Araneum Anglicum и в разделе [поиска](http://ucts.uniba.sk/guest/run.cgi/first_form?corpname=AranAngl_x;align=) задаём наш запрос: _[word=".\*ica?l?" & tag="JJ"]_.

![alt-text](./google-spreadsheets%20images/Araneum-to-GS_01.png "Запрос в корпус")

Получаем выдачу и __сохраняем её__:

![alt-text](./google-spreadsheets%20images/Araneum-to-GS_02.png "Расположение кнопки Save")

__Параметры сохранения__: обратите внимание, что вы сохраняете *текст*. 

![alt-text](./google-spreadsheets%20images/Araneum-to-GS_03.png "Параметры сохранения")

Дальнейшие действия по зависят от вашей операционной системы:
  * если у вас __Windows__, то нажимайте на кнопку Save Concordance. В появившемся окошке будут две опции: одна с именем файла (по умолчанию — *conc*), вторая — обозначающая тип файлов. Вот в этой второй выберите *Все файлы*, а файлу *conc* припишите расширение *.csv*.
  * если у вас __Mac OS__, то дайте файлу сохраниться в формате *txt*, а потом переименуйте его в *conc.csv*. Мак будет ругаться и сопротивляться, но продолжайте настаивать на своём!
  
![alt-text](./google-spreadsheets%20images/Araneum-to-GS_04.png "Переименовываем в CSV")

![alt-text](./google-spreadsheets%20images/Araneum-to-GS_05.png "Соглашаемся на изменения")

![alt-text](./google-spreadsheets%20images/Araneum-to-GS_06.png "Результат")

__Загрузите таблицу в Google Таблицы__ (об этом см. выше) и разделите результат на ячейки при помощи функции `=SPLIT(ячейка_с_текстом; "<>")`. Результаты работы функции __вставьте как значения__ (об этом тоже выше).

# Удачи!
